---
description: Акторная модель и ее свойства
---

# Actor Model

Данная модель была разработана для конкурентных/параллельных вычислений еще полвека назад. Она определяет некоторые ключевые правила как системные компоненты должны себя вести и как взаимодействовать друг с другом.

Один из самых популярных языков программирования, использующих эту модель - [Erlang](https://erlang.org) (акторная модель лежит в основе его виртуальной машины BEAM). Erlang в качестве акторов использует легковесные процессы в рамках своей виртуальной машины. Эти процессы обмениваются между собой сообщениями, в том числе и между распределенными процессами. Так реализуется сетевая прозрачность для акторов.

Существуют также реализации этой модели и в других языках. Например, в JAVA есть [фреймворк Akka](https://www.akka-technologies.com). Он предоставляет очень мощьный инструмент для создания решений на основе акторной модели, но, к сожалению, не предоставляет возможности работать с инфраструктурой Erlang нативно.

Ergo Framework реализует акторную модель с готовыми дизайн-паттернами (behaviors), а также реализует полный сетевой стек Erlang (протокол DIST и формат данных ETF). Это дает возможность интегрироваться с инфраструктурой Erlang нативным образом, без необходимости транскодирования данных или адаптации механизмов взаимодействия акторов (обмен сообщениями, линковка, мониторинг).

### Актор

Актором является базовая единица вычислительной системы. В Ergo Framwork в качестве актора используется надстройка над легковесным процессом goroutine - [gen.Server](../generic-behaviors/server/). Взаимодействие между акторами производится через асинхронные сообщения и каждый актор имеет "почтовый ящик" для них. Объем такого ящика в Ergo Framework можно задать при старте актора `node.Spawn(...)` используя параметр `gen.ProcessOptions{MailboxSize: N, ...}`. Обработка почтового ящика производится последовательно в порядке очереди FIFO.

Одним из ключевых особенностей актора является - изолированный state процесса, доступ которому имеет только сам процесс. В Ergo Framework state актора находится в `gen.ServerProcess.State`, где может хранить любые данные.

Помимо получения сообщений и их последующей обработки, актор может:

* отправлять сообщения используя `gen.ServerProcess.Send(...)`, `gen.ServerProcess.Cast(...)` для асинхронных собщений, а также `gen.ServerProcess.Call(...)` для синхронной отправки сообщений
* создавать новые акторы используя `gen.ServerProcess.Spawn(...)`
* модифицировать свой state в процессе обработки входящих сообщений

### Отказоустойчивость

В отличие от Erlang, где изолированность процессов гарантируется виртуальной машиной BEAM, в Golang нет возможности полностью изолировать влияние goroutineдруг на друга в случае краха одной из них. Однако, Golang предоставляется возможность обработки состояния паники goroutine используя механизм recover.

В Ergo Framework каждый актор имеет обработку состояния паники goroutine. Это дает возможность избежать краха всего приложения. Вместе с этим, необходимо быть внимательным при создании собственных goroutines. Отсутсвие обработчика состояния паники приведет к падению всего приложения. Убидитесь, что ваш код содержит обработку таких ситуаций.

### Распределенные вычисления и сетевая прозрачность
