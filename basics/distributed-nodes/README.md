---
description: Распределенные вычисления и сетевая прозрачность
---

# Distributed Nodes

Одной из ключевых возможностей Ergo Framework является сетевая прозрачность. Она обеспечивается благодаря использованию унифицированного формата адреса процесса `etf.Pid` и сетевого стека - протокол DIST и формат данных ETF. Таким образом, вы можете не думать о сетевой части взаимодействия между процессами, запущенными на разных нодах - когда вы отправляете сообщение процессу, который принадлежит удаленной ноде, Ergo Framework автоматически создаст сетевое подлючение с ней и отправит сообщение заданному процессу.&#x20;

\-----

Номер порта для входящих подключений выбирается динамически, либо можно указать явно номер используя опцию `node.Options.Listen`, либо диапазон портов опциями `node.Options.ListenBegin` и `node.Options.ListenEnd`.

На одном хосте может быть запущено множество нод, но все они должны иметь уникальные имена. Контроль уникальности имен для запускаемых нод на хосте, осуществляется с помощью встроенного в ноду EMPD сервиса. Он выполняет функцию регистратора запущенных нод. При старте ноды EMPD сервис пытается запуститься в режиме сервера, используя порт 4369. Если этот порт уже занят, то он переключается в режим клиента и подключается к этому порту для регистрации ноды. Это подключение остается живым до момента останова ноды. &#x20;

{% hint style="info" %}
EPMD - это Erlang Port Mapper Daemon. В Erlang это отдельная программа, которая запускается Erlang-нодой при первом старте и остается запущенной все время, пока ее явно не остановят. В Ergo Framework этот функционал встроен в ноду.&#x20;

Реализация EPMD в Ergo Framework полностью совместима с реализацией Erlang, поэтому Erlang ноды успешно подключаются к EMPD серверу, встроенному в ноду на базе Ergo Framework и наоборот.
{% endhint %}

Регистрация ноды включает в себя предоставление информации об имени ноды, номера порта для входящих подключений, а также набор флагов cо служебной информацией.

В задачу EPMD входит не только регистрация нод, но и функция определения порта по имени ноды. Каждая нода, при попытке подключиться к удаленной ноде сначала обращается к EPMD серверу, запущенному на том же хосте, где запущена удаленная нода, с запросом номера порта по имени ноды. Получив его, производится установка сетевого подключения между нодами с последующей процедурой хендшейка.

Для EPMD разрыв такого соединения означает останов ноды. Для ноды разрыв такого соединения (если она не завершает свою работу) означает, что другая нода, выполняющая функцию EPMD-сервера была остановлена. В этом случае EPMD клиент ноды старается переключиться в режим сервера, чтобы выполнять функцию регистратора для остальных нод, запущенных на этом хосте.

\----

рассказать про RPC и RemoteSpawn
